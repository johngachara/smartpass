<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://www.unpkg.com/react@16.7.0/umd/react.production.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Upload Photo</title>
</head>
<body>
<div class="px-4 pt-5 my-5 text-center border-bottom">
    <!-- ... (your existing code) ... -->
    <video id="camera" width="640" height="480" autoplay></video>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.getElementById('camera');
            const captureButton = document.getElementById('captureButton');
            const recaptureButton = document.getElementById('recaptureButton');
            const uploadButton = document.getElementById('uploadButton');
            const completeRegButton = document.getElementById('complete_reg');
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            let recapture = false;

            function initCamera() {
                navigator.mediaDevices.enumerateDevices()
                    .then(devices => {
                        const videoDevices = devices.filter(device => device.kind === 'videoinput');
                        if (videoDevices.length > 1) {
                            // If there are multiple cameras, toggle between them
                            const currentDeviceIndex = videoDevices.findIndex(device => device.label === video.srcObject.getVideoTracks()[0].label);
                            const nextDeviceIndex = (currentDeviceIndex + 1) % videoDevices.length;
                            const nextDeviceId = videoDevices[nextDeviceIndex].deviceId;
                            const constraints = { video: { deviceId: { exact: nextDeviceId } } };

                            return navigator.mediaDevices.getUserMedia(constraints);
                        } else {
                            // If there is only one camera, use it
                            return navigator.mediaDevices.getUserMedia({ video: true });
                        }
                    })
                    .then((stream) => {
                        video.srcObject = stream;
                    })
                    .catch((error) => {
                        console.error('Error accessing camera:', error);
                    });
            }

            initCamera();

            window.capturePhoto = function() {
                // ... (your existing capturePhoto code) ...
            };

            window.recapture = function() {
                // ... (your existing recapture code) ...
            };

            window.sendPhoto = function() {
                // ... (your existing sendPhoto code) ...
            };

            // Add a click event listener to the captureButton to toggle between front and back cameras
            captureButton.addEventListener('click', () => {
                initCamera();
            });
        });
    </script>
</div>
</body>
</html>
